"use strict";(globalThis["webpackChunkvnm_static_h5"]=globalThis["webpackChunkvnm_static_h5"]||[]).push([[9266],{79266:(e,t,o)=>{o.r(t),o.d(t,{default:()=>$});var a=o(61758),n=o(58790),i={class:"personal-account"},l={class:"flex items-center no-wrap"},r={class:"q-ml-md"},c={key:0,class:"text-center q-mt-md"},u={class:"q-px-lg q-pt-sm q-pb-lg"},s=["src","title"];function d(e,t,o,d,m,p){var f=(0,a.g2)("q-input"),b=(0,a.g2)("q-btn"),h=(0,a.g2)("q-form"),g=(0,a.g2)("q-toolbar-title"),v=(0,a.g2)("q-toolbar"),_=(0,a.g2)("q-card-section"),R=(0,a.g2)("q-card"),y=(0,a.g2)("q-dialog"),C=(0,a.gN)("close-popup");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",i,[(0,a.bF)(h,{ref:"profileFormRef"},{default:(0,a.k6)((function(){return[(0,a.Lk)("div",l,[(0,a.bF)(f,{standout:"",class:"q-pb-xs","hide-bottom-space":"",modelValue:e.formDetail.email,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.formDetail.email=t}),label:e.$t("lang.personal_email"),"lazy-rules":"",rules:[function(t){return t&&t.length>0||e.$t("lang.personal_email_val")}],readonly:!e.showVerifyBtn,style:{width:"100%"}},null,8,["modelValue","label","rules","readonly"]),(0,a.Lk)("div",r,[(0,a.bF)(b,{size:"md",color:"brightbtn",label:e.showVerifyBtn&&e.otpCountdownCount<=0?e.$t("lang.personal_sendotp"):"".concat(e.$t("lang.personal_sentotp_countdown")," ").concat(e.otpCountdownCount),onClick:t[1]||(t[1]=function(t){return e.openVerificationDialog()}),style:{"white-space":"nowrap"},disable:!e.showVerifyBtn&&e.otpCountdownCount>0},null,8,["label","disable"])])]),(0,a.bF)(f,{standout:"",class:"q-pb-xs","hide-bottom-space":"",ref:"emailOtpRef",modelValue:e.formDetail.emailOtpRef,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.formDetail.emailOtpRef=t}),type:"tel",label:e.$t("lang.personal_emailotp"),"lazy-rules":"",rules:[function(t){return t&&t.length>5&&t.length<7||e.$t("lang.personal_emailotp_val")}],style:{width:"100%"}},null,8,["modelValue","label","rules"]),e.canEdit?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.bF)(b,{size:"md",color:"brightbtn",onClick:t[3]||(t[3]=function(t){return e.submitUpdateSecurity()}),label:e.$t("lang.personal_submit_btn")},null,8,["label"])])):(0,a.Q3)("",!0)]})),_:1},512)]),(0,a.bF)(y,{modelValue:e.showCaptchaDialog,"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.showCaptchaDialog=t}),width:"100%","no-backdrop-dismiss":""},{default:(0,a.k6)((function(){return[(0,a.bF)(R,{width:"100%"},{default:(0,a.k6)((function(){return[(0,a.bF)(_,{class:"q-pa-md bg-brightbtn text-white"},{default:(0,a.k6)((function(){return[(0,a.bF)(v,null,{default:(0,a.k6)((function(){return[(0,a.bF)(g,null,{default:(0,a.k6)((function(){return[(0,a.eW)((0,n.v_)(e.$t("lang.personal_verification")),1)]})),_:1}),(0,a.bo)((0,a.bF)(b,{flat:"",round:"",dense:"",icon:"close"},null,512),[[C]])]})),_:1})]})),_:1}),(0,a.Lk)("div",u,[(0,a.bF)(_,{class:"q-mb-md q-pa-md"},{default:(0,a.k6)((function(){return[(0,a.bF)(f,{modelValue:e.innerCaptchaRef,"onUpdate:modelValue":t[5]||(t[5]=function(t){return e.innerCaptchaRef=t}),placeholder:e.$t("lang.personal_verification")},{append:(0,a.k6)((function(){return[(0,a.Lk)("img",{src:e.verificationImg,title:e.$t("lang.personal_verification_refresh"),style:{"margin-top":"6px",cursor:"pointer"},onClick:t[4]||(t[4]=function(){return e.getCode&&e.getCode.apply(e,arguments)})},null,8,s)]})),_:1},8,["modelValue","placeholder"])]})),_:1}),(0,a.bF)(b,{onClick:e.onCaptchaSubmit,label:e.$t("lang.personal_sendotp"),color:"brightbtn"},null,8,["onClick","label"])])]})),_:1})]})),_:1},8,["modelValue"])],64)}var m=o(38734),p=o(85038),f=o.n(p),b=o(88122),h=o(60455),g=o(43710),v=o(15868),_=o(23537);const R=(0,a.pM)({name:"PersonalView",setup:function(){var e=o(54760),t=(0,h.rd)(),n=(0,_.s9)(),i=n.t,l=(0,g.A)(),r=(0,m.Kh)({start:"",end:""}),c=(0,m.KR)(),u=(0,v.Z)(),s=function(){p.memberInfo=(0,v.Z)(),p.memberInfo.birthday>0&&(p.memberInfo.birthday=f()(p.memberInfo.birthday).format("YYYY-MM-DD")),U.nickName=p.memberInfo.nickName,U.realName=p.memberInfo.realName,U.birthday=p.memberInfo.birthday,U.email="",U.phone=p.memberInfo.phone,U.phoneVerified=p.memberInfo.phoneVerified},d=(0,m.KR)(!1),p=(0,m.Kh)({memberInfo:{}}),R=(0,m.Kh)({});(0,a.sV)((function(){s(),V()}));var y,C=(0,m.KR)(""),K=(0,m.KR)(""),V=function(){b.api.get("/member/verificationCode").then((function(e){0===e.code&&(K.value="data:image/png;base64,"+e.data.img,F.codeId=e.data.id,X.value="")}))["catch"]((function(e){l.notify({color:"negative",position:"top",message:e.message,icon:"report_problem"})}))},k=(0,m.KR)(!1),I=(0,m.KR)(!1),w=(0,m.KR)(),F=(0,m.Kh)({mobileNumber:"",verificationCode:""}),q=(0,m.KR)(!1),A=function(){F.emailAddress="",F.verificationCode="",I.value=!0},E=function(){V(),q.value=!0},D=function(){k.value=!0,R.memberInfo.email=F.emailAddress;var t={email:F.emailAddress,captchaCode:F.captchaCode,codeId:F.codeId};b.api.post("/otp/sendNewEmail",e.stringify(t)).then((function(e){0===e.code?(l.notify({color:"positive",position:"top",message:i("lang.personal_emailotp_sent"),icon:"check_circle_outline"}),d.value=!0,R.memberInfo.codeId=e.data.codeId,q.value=!1,k.value=!1):(k.value=!1,V())}))["catch"]((function(e){V(),k.value=!1}))},S=(0,m.KR)(),$=(0,m.KR)(),N=function(){if(Y.value.validate(),Y.value.hasError);else{var o="session/verifyEmailForVNM";b.api.post(o,e.stringify({email:U.email,code:U.emailOtpRef,codeId:C.value})).then((function(e){0===e.code&&(l.notify({color:"positive",position:"top",message:i("lang.personal_verification_successful"),icon:"check_circle_outline"}),u.emailVerified=!0,u.email=U.email,t.go(-1))}))["catch"]((function(e){l.notify({color:"negative",position:"top",message:e.message,icon:"report_problem"})}))}},Q=(0,m.KR)(!1),M=(0,m.KR)(!1),x=(0,m.KR)(!1),B=(0,m.KR)(!1),T=(0,m.KR)(!1),U=(0,m.Kh)([]),L=(0,m.KR)(),O=(0,m.KR)(),z=(0,m.KR)(),Y=(0,m.KR)(),P=(0,m.KR)(),X=(0,m.KR)(),Z=(0,m.KR)(!1),W=(0,m.KR)(!0),j=(0,m.KR)(!1),G=(0,m.KR)(0),H=function(){G.value=60,y=setInterval((function(){if(G.value<=0)return W.value=!0,void clearInterval(y);G.value--}),1e3)},J=function(){V(),Z.value=!0},ee=function(){if(!U.email)return l.notify({color:"negative",position:"top",message:i("lang.personal_email_empty"),icon:"report_problem"}),void V();b.api.post("/otp/sendEmail",e.stringify({email:U.email,captchaCode:X.value,codeId:F.codeId})).then((function(e){V();var t=e.message||i("lang.personal_emailotp_sent"),o="positive";0===e.code?(d.value=!0,Z.value=!1,W.value=!1,j.value=!0,H(),C.value=e.data.codeId):o="negative",V(),t&&l.notify({message:t,color:o}),V()}))};return{router:t,searchForm:r,personalState:p,updateSecurityFormRef:w,updateSecurityVerified:F,updateSecurityModal:A,updateSecurityModalVisible:I,submitUpdateSecurity:N,isEditRealName:Q,isEditEmail:M,isEditPhone:x,isEditBirthday:B,formDetail:U,profileFormRef:c,verificationModalVisible:q,openVerificationModal:E,isEmailSending:k,verificationImg:K,emailCodeId:C,verifyVerificationCode:D,getCode:V,verificationDetails:R,verificationCodeRef:$,emailAddressRef:S,isEdit:T,emailRef:z,emailOtpRef:Y,realNameRef:L,birthdayRef:O,moment:f(),canEdit:d,otpCountdownCount:G,showVerificationTokenInput:j,captchaRef:P,innerCaptchaRef:X,showCaptchaDialog:Z,openVerificationDialog:J,onCaptchaSubmit:ee,showVerifyBtn:W}}});var y=o(12807),C=o(21565),K=o(68926),V=o(69001),k=o(57201),I=o(97569),w=o(27066),F=o(79351),q=o(56769),A=o(79197),E=o(98582),D=o.n(E);const S=(0,y.A)(R,[["render",d]]),$=S;D()(R,"components",{QForm:C.A,QInput:K.A,QBtn:V.A,QDialog:k.A,QCard:I.A,QCardSection:w.A,QToolbar:F.A,QToolbarTitle:q.A}),D()(R,"directives",{ClosePopup:A.A})}}]);